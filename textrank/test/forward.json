{"date": "2014-11-01T00:30:50+00:00", "id": "CALk5AbqSEhiDuD3PBTaX1GVKEr2ojYjACj9WyHvcd0qt2scMQw", "next_thread": "CALrNVjUR6eqofD-xDc61a14rp1ojWjQ=c1AqKx685iJc2V2YxQ", "next_url": "http://mail-archives.apache.org/mod_mbox/spark-user/201411.mbox/%3cCALrNVjUR6eqofD-xDc61a14rp1ojWjQ=c1AqKx685iJc2V2YxQ@mail.gmail.com%3e", "prev_thread": "CAPX+=eFM5n5xq=CJALMjsYPnR+duvGaYaoZVCNaLzZ6qOHnU2g", "sender": "Kevin Paul <kevinpaulap...@gmail.com>", "subject": "Some of the statistics function in SparkSQL is very slow", "text": "\nHi all, some of the statistics function that I tried in HiveContext is\nvery slow, notably percentile, var_sampl, the symptom is same as what\nI describe in my previous email,  when I do schemaRDD.collect on the\nresulting RDD, the shuffle size is around 1000GB, could I do anything\nelse to speed up this?\n\nThanks,\nKevin Paul\n---------- Forwarded message ----------\nFrom: Kevin Paul <kevinpaulapple@gmail.com>\nDate: Sat, Oct 25, 2014 at 8:48 PM\nSubject: HiveSQL percentile is query slow\nTo: user <user@spark.apache.org>\n\n\nHi all, I tried to run the following sql command in HiveContext with\nmy table loaded into memory:\n  SELECT percentile(myColumn, array(0.1, 0.5)) FROM myTable\n\nThe query took more than 5 minutes to complete, but the query like\n  SELECT min(myColumn), max(myColumn) FROM myTable\nonly took around 10 seconds to run.\n\nMy Spark version is 1.2.0 SNAPSHOT, the cluster is 10 slaves, and the\ndataset is 10G, and I'm running on Yarn-client mode.\nThe query took two stages to run:\n 1st. is mapPartitions at Exchanged.scala:86  with duration 9s\n 2nd. is collect at SparkPlan.scala: 85 with duration 5.3 min\n\nI attach the Summary Metrics for the collect task here\nThanks,\nKevin Paul\n\n"}
